<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Go WebAssembly</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            padding: 50px;
        }
        #loading {
            font-weight: bold;
            color: #555;
        }
    </style>
</head>
<body>
    <h1>Aplikasi Go WebAssembly</h1>
    
    <div id="loading">Memuat WebAssembly...</div>
    
    <button id="btn-click" style="display:none;">Klik Saya (Fungsi Go)</button>

    <script src="wasm_exec.js"></script>

    <script>
        // Cek apakah browser support WASM
        if (!WebAssembly.instantiateStreaming) { 
            WebAssembly.instantiateStreaming = async (resp, importObject) => {
                const source = await (await resp).arrayBuffer();
                return await WebAssembly.instantiate(source, importObject);
            };
        }

        const go = new Go();
        
        // Load file .wasm (Pastikan nama file sama dengan hasil build Anda)
        WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject).then((result) => {
            // Hilangkan pesan loading
            document.getElementById("loading").style.display = "none";
            document.getElementById("btn-click").style.display = "inline-block";
            
            console.log("Go WASM berhasil dimuat!");
            go.run(result.instance);
        }).catch((err) => {
            console.error("Gagal memuat WASM:", err);
            document.getElementById("loading").innerText = "Gagal memuat aplikasi. Cek Console.";
        });
    </script>
</body>
</html>
